'use strict';

const Command = require('../Command');
const BatchExecutionInfoBuilder = require('../../batch/BatchExecutionInfoSerialBuilder');


/**
 * Starts the creation of ordered command lists
 *
 * @extends Command
 */
class BatchExecutionInfoBuilderCommand extends Command {

    /**
     * Constructor
     *
     * @param {BatchContext} batchContext The current batch context instance
     */
    constructor(batchContext) {
        super(null);

        /**
         * Batch context
         * @type {BatchContext}
         * @private
         */
        this._batchContext = batchContext;
    }

    /**
     * Executes the BatchExecutionListBuilder. The builder is obtained from the component manager of the service,
     * so it can be overwritten by  the application
     *
     * @param {Command~Next} next The callback to execute inside the listener.
     */
    execute(next) {
        const commands = BatchExecutionInfoBuilder.build(this._batchContext);
        this._batchContext.setExecutionInfo(commands);

        return next();
    }
}

module.exports = BatchExecutionInfoBuilderCommand;
