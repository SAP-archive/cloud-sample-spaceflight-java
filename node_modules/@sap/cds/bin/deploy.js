module.exports = Object.assign(deploy, {
  options: ['--to'],
  shortcuts: ['-2'],
  help: `
# SYNOPSIS

    *cds deploy* [ <model> ] [ -to <database> ]

    Deploys the given model to a database. If no model is given it looks up
    according configuration from _package.json_ or _.cdsrc.json_. Same for
    the database.

`})

function deploy ([model], options) {
  const cds = require('../lib/index')
  if (!model) model = cds.config.data.model
  cds.connect(options.to).deploy(model || 'db')
    .then(() => {
        return cds.disconnect()
    })
    .catch(e => {
      if (!model && e.code === 'MODEL_NOT_FOUND') {
        throw new Error('Please specify a data model or configure one in package.json#cds.data.model')
      }

      throw e
    })
}
