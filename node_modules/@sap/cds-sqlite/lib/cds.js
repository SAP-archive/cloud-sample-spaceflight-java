const _notInjected = () => {
  throw new Error('This method requires `cds` to be injected')
}

const _validateInjection = (cds) => {
  if (!cds || typeof cds !== 'object') {
    throw new Error('Injected value is not of type `cds`')
  }
}

const injection = {
  cds: {
    parse: {
      cql: _notInjected
    }
  },
  inject (cds) {
    _validateInjection(cds)

    injection.cds = cds
    require('@sap/cds-sql').inject(cds)
  },
  parse: {
    cql (arg) {
      return injection.cds.parse.cql(arg)
    }
  },
  get config () {
    return injection.cds.config || {}
  }
}

module.exports = injection
